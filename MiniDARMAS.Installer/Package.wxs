<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  
  <!-- Product Definition -->
  <Package 
    Name="Digital Meeting Management System"
    Manufacturer="ethio-man"
    Version="1.0.0.0"
    UpgradeCode="8E5C3A2F-1B4D-4F6E-9A8C-7D2E5F0B3A1C"
    Scope="perMachine">
    
    <MajorUpgrade 
      DowngradeErrorMessage="A newer version of [ProductName] is already installed." 
      AllowSameVersionUpgrades="yes" />
    
    <MediaTemplate EmbedCab="yes" />
    
    <!-- Icon for Add/Remove Programs -->
    <Icon Id="ProductIcon" SourceFile="MiniDARMAS.ico" />
    <Property Id="ARPPRODUCTICON" Value="ProductIcon" />
    <Property Id="ARPHELPLINK" Value="https://github.com/ethio-man/Digital-Meeting-Management-System" />
    
    <!-- Directory Structure -->
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="MiniDARMAS" />
    </StandardDirectory>
    
    <!-- Start Menu -->
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Digital Meeting Management System" />
    </StandardDirectory>
    
    <!-- Desktop Folder Reference -->
    <StandardDirectory Id="DesktopFolder" />
    
    <!-- Component Group for all files harvested from publish folder -->
    <!-- Note: 'PublishedFiles' component group is now automatically generated by the build system (Heat) -->
    
    <!-- Start Menu Shortcuts -->
    <ComponentGroup Id="StartMenuShortcuts" Directory="ApplicationProgramsFolder">
      <Component Id="StartMenuShortcut" Guid="C3D4E5F6-A7B8-4C9D-0E1F-2A3B4C5D6E7F">
        <Shortcut Id="StartMenuApplicationShortcut"
                  Name="Digital Meeting Management System"
                  Target="[INSTALLFOLDER]MiniDARMAS.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="ProductIcon" />
        <RemoveFolder Id="CleanUpStartMenuFolder" On="uninstall" />
        <RegistryValue Root="HKCU" 
                       Key="Software\ethio-man\MiniDARMAS" 
                       Name="installed" 
                       Type="integer" 
                       Value="1" 
                       KeyPath="yes" />
      </Component>
    </ComponentGroup>
    
    <!-- Desktop Shortcuts -->
    <ComponentGroup Id="DesktopShortcuts" Directory="DesktopFolder">
      <Component Id="DesktopShortcut" Guid="D4E5F6A7-B8C9-4D0E-1F2A-3B4C5D6E7F8A">
        <Shortcut Id="DesktopApplicationShortcut"
                  Name="Digital Meeting Management System"
                  Target="[INSTALLFOLDER]MiniDARMAS.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="ProductIcon" />
        <RegistryValue Root="HKCU" 
                       Key="Software\ethio-man\MiniDARMAS" 
                       Name="desktopShortcut" 
                       Type="integer" 
                       Value="1" 
                       KeyPath="yes" />
      </Component>
    </ComponentGroup>
    
    <!-- Feature Definition -->
    <Feature Id="MainApplication" Title="Digital Meeting Management System" Level="1">
      <ComponentGroupRef Id="PublishedFiles" />
      <ComponentGroupRef Id="StartMenuShortcuts" />
      <ComponentGroupRef Id="DesktopShortcuts" />
    </Feature>
    
  </Package>
</Wix>
